# Excel 用のオートメーション アドインとしてマネージ コードを使用する

## Visual Studio とマネージ コードを使用した、Excel 用のオートメーション アドインの作成
1. Visual Studio を管理者権限で起動します。
1. ExcelAddIn という名前の新しい Visual C# クラス ライブラリ プロジェクトを作成します。
1. [プロジェクト] メニューの [プロパティ] をクリックし、[ビルド] ペイン内をクリックします。[COM 相互運用機能の登録] チェック ボックスをオンにします。COM 相互運用機能のため、アセンブリが自動的に登録されます。
1. [アプリケーション]ペイン内をクリックします。[アセンブリ情報]ボタンをクリックします。[アセンブリをCOM参照可能にする]チェック ボックスをオンにします。
1. [デバッグ]ペイン内をクリックします。[外部プログラムの開始]にEXCEL.EXEを指定します。

## Excel アドインの実行
- ExcelAddIn プロジェクトを構築し、F5 キーを押してコンパイルします。
- Excel で新しいブックを開きます。
- [ツール] メニューの [アドイン] をポイントし、[オートメーション] をクリックします。
- [オートメーション サーバー] ダイアログ ボックスのアドインの一覧の [ExcelAddIn] をクリックし、[OK] をクリックします。
- ブックのセルに「=Tax(23500)」と入力します。セルに 3175 と表示されます。
- ExcelAddIn.dll を別のディレクトリに移動した後に登録するには、/codebase を使用して regasm を実行します。アセンブリが署名されていないという警告が表示される場合があります。

# 出典
[方法 : Excel 用のオートメーション アドインとしてマネージ コードを使用する (C# プログラミング ガイド)](https://msdn.microsoft.com/ja-jp/library/ms173189(v=vs.80).aspx)